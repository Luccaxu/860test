{"version":3,"file":"index-35bdf15e.js","sources":["../../src/index.js"],"sourcesContent":["import data from './data.json'\n\n// const api_key = import.meta.env.VITE_API_KEY\nconst api_key =\"AIzaSyCTxva61j1ywo7lP-8fBeEHPCjOu_OuDf8\"\n\n//Access google map and search function\nconst mapScript = document.createElement('script')\nmapScript.src = `https://maps.googleapis.com/maps/api/js?key=${api_key}&callback=initAutocomplete&libraries=maps,marker,places&v=weekly`\nmapScript.defer = true\n\ndocument.head.appendChild(mapScript)\n\n//Initialize variables\nlet map, lat, lng\nlet filterTypeName = ''\n//Access filter content\nconst filterDiv = document.getElementById('filter')\nconst btn = document.getElementById('filterBtn')\nconst filterList = document.getElementById('filterList')\nconst filterItems = document.querySelectorAll('.filterItem')\nconst filterItemsArray = [...filterItems]\nlet filterResults = []\n\nbtn.addEventListener('click', (e) => {\n    e.preventDefault()\n\n    if (!filterList.parentNode) {\n        filterListAdd()\n    } else {\n        filterListRemove()\n    }\n})\n\n//Remove filterList at first page loading\nfunction filterListRemove() {\n    if (filterList.parentNode) {\n        filterList.parentNode.removeChild(filterList)\n    }\n}\n\nfilterListRemove()\n\n//Add filterList when btn be clicked\nfunction filterListAdd() {\n    filterDiv.appendChild(filterList)\n}\n\nlet currentType = null\nlet filterMarkers = []\n//Iterate filter items array\nfilterItemsArray.forEach((item) => {\n    item.addEventListener('click', () => {\n        filterTypeName = item.childNodes[3].textContent.toLowerCase().trim()\n\n        if (filterTypeName === currentType) {\n            setMapOnAll(null)\n            filterMarkers = []\n        } else {\n            currentType = filterTypeName\n            initNearbySearch(filterTypeName)\n        }\n\n    })\n})\n\n//Setup Autocomplete function with search box\nfunction initAutocomplete() {\n    //create a map instance\n    map = new google.maps.Map(document.getElementById(\"map\"), {\n        center: {\n            lat: data.map.location.latitude,\n            lng: data.map.location.longitude\n        },\n        restriction: {\n            latLngBounds: data.map.bounds,\n            strictBounds: false\n        },\n        zoom: data.map.zoom,\n        mapTypeId: data.map.mapType,\n        mapTypeControl: false,\n        streetViewControl: false,\n        fullscreenControl: false\n    })\n    pinMarkers()\n\n    const input = document.getElementById(\"searchBar\")\n    //bind with input\n    const searchBox = new google.maps.places.SearchBox(input)\n\n    map.controls[google.maps.ControlPosition.TOP_CENTER].push(input)\n    map.addListener(\"bounds_changed\", () => {\n        searchBox.setBounds(map.getBounds())\n    })\n\n    let markers = []\n\n    searchBox.addListener(\"places_changed\", () => {\n        const places = searchBox.getPlaces()\n\n        if (places.length == 0) {\n            console.log('Sorry this place missed, please give another try.')\n            return;\n        }\n\n        markers.forEach((marker) => {\n            marker.setMap(null)\n        })\n        markers = []\n\n        const bounds = new google.maps.LatLngBounds()\n\n        places.forEach((place) => {\n            if (!place.geometry || !place.geometry.location) {\n                console.log(\"Returned place contains no geometry\")\n                return\n            }\n\n            const starIcon = {\n                url: '/star.png',\n                size: new google.maps.Size(71, 71),\n                origin: new google.maps.Point(0, 0),\n                anchor: new google.maps.Point(17, 34),\n                scaledSize: new google.maps.Size(32, 32),\n            }\n\n            markers.push(\n                new google.maps.Marker({\n                    map,\n                    icon: starIcon,\n                    title: place.name,\n                    position: place.geometry.location,\n                }),\n            )\n\n            if (place.geometry.viewport) {\n                bounds.union(place.geometry.viewport);\n            } else {\n                bounds.extend(place.geometry.location);\n            }\n\n            lat = place.geometry.location.lat()\n            lng = place.geometry.location.lng()\n        })\n\n        map.fitBounds(bounds);\n    })\n}\n\nwindow.initAutocomplete = initAutocomplete\n\n//Change searchBar style based on input value, but not check if it is valid search keyword\nconst bar = document.getElementById('searchBar')\n\nbar.addEventListener('input', () => {\n    const inputText = bar.value\n    const textLength = inputText.length\n\n    if (textLength > 0) {\n        bar.style.borderRadius = '24px 24px 0 0'\n    } else {\n        bar.style.borderRadius = '24px'\n    }\n})\nbar.addEventListener('blur', () => {\n    bar.style.borderRadius = '24px'\n})\n\n//Create pin markers\nfunction pinMarkers() {\n    data.landmark.forEach(obj => {\n        let title = Object.keys(obj)[0]\n        let position = obj[title].position\n        let name = obj[title].name\n        let imgUrl = obj[title].img\n        let address = obj[title].address\n        let scaledSize = obj[title].scaleSize\n        let htmlNum = obj[title].num\n\n        const landmarkIcon = {\n            url: `/${title}.png`,\n            size: new google.maps.Size(72, 72),\n            origin: new google.maps.Point(0, 0),\n            anchor: new google.maps.Point(20, 40),\n            scaledSize: new google.maps.Size(48, scaledSize),\n        }\n\n        const landmarkMaker = new google.maps.Marker({\n            position: position,\n            map: map,\n            icon: landmarkIcon,\n            title: name\n        })\n\n        landmarkMaker.setMap(map)\n\n        //Setup Info window for landmark\n        const infoWindow = new google.maps.InfoWindow()\n\n        landmarkMaker.addListener('mouseover', () => {\n            const contentString =\n                '<div id=\"infoContent\">' +\n                '<div id=\"siteNotice\">' +\n                '</div>' +\n                `<img src=${imgUrl} class=\"infoImg\"/>` +\n                '</div>' +\n                `<h1 id=\"infoHeading\" class=\"infoHeading\">${name}</h1>` +\n                `<span id=\"infoDes\" class=\"infoDes\">${address}</span>`\n\n            infoWindow.setContent(contentString)\n            infoWindow.open(map, landmarkMaker)\n        })\n        landmarkMaker.addListener(\"mouseout\", () => {\n            infoWindow.close();\n        })\n\n        landmarkMaker.addListener('click', () => {\n            let sectionId = ['towerPart', 'musuemPart', 'sacrePart', 'arcdePart']\n\n            switch (htmlNum) {\n                case 1:\n                    window.location.href = `./intro.html#${sectionId[0]}`\n                    break\n                case 2:\n                    window.location.href = `./intro.html#${sectionId[2]}`\n                    break\n                case 3:\n                    window.location.href = `./intro.html#${sectionId[3]}`\n                    break\n                case 4:\n                    window.location.href = `./intro.html#${sectionId[1]}`\n                    break\n            }\n\n        })\n    })\n}\n\n//Nearby search requests\nfunction initNearbySearch(queryName) {\n    console.log('filter type', queryName)\n    //changing the nearby search radius based on whether a place is selected or not\n    let selectedCenter, selectedRadius\n\n    if (lat && lng) {\n        selectedCenter = new google.maps.LatLng(lat, lng)\n        selectedRadius = 3000\n    } else {\n        selectedCenter = new google.maps.LatLng(data.map.location.latitude, data.map.location.longitude)\n        selectedRadius = 10000\n    }\n\n    const request = {\n        location: selectedCenter,\n        radius: selectedRadius,\n        type: [`${queryName}`]\n    }\n\n    const service = new google.maps.places.PlacesService(map)\n    service.nearbySearch(request, callback)\n\n}\n\n//Nearby search callback\nfunction callback(results, status) {\n    if (status == google.maps.places.PlacesServiceStatus.OK) {\n        for (const place of results) {\n            filterResults.push(place)\n            filterPlaceMarker(place)\n        }\n        console.log('nearbyResults', results)\n    }\n}\n\n\n//Markers create when filter item be selected\nfunction filterPlaceMarker(place) {\n    const selectedIcon = {\n        url: `/${filterTypeName}.png`,\n        size: new google.maps.Size(70, 85),\n        origin: new google.maps.Point(0, 0),\n        anchor: new google.maps.Point(20, 40),\n        scaledSize: new google.maps.Size(40, 50),\n    }\n\n    const marker = new google.maps.Marker({\n        position: place.geometry.location,\n        map: map,\n        icon: selectedIcon\n    })\n    filterMarkers.push(marker)\n\n\n    setMapOnAll(map)\n\n}\n\nfunction setMapOnAll(map) {\n    for (let i = 0; i < filterMarkers.length; i++) {\n        filterMarkers[i].setMap(map)\n    }\n}"],"names":["api_key","mapScript","map","lat","lng","filterTypeName","filterDiv","btn","filterList","filterItems","filterItemsArray","e","filterListRemove","filterListAdd","currentType","filterMarkers","item","setMapOnAll","initNearbySearch","initAutocomplete","data","pinMarkers","input","searchBox","markers","places","marker","bounds","place","starIcon","bar","obj","title","position","name","imgUrl","address","scaledSize","htmlNum","landmarkIcon","landmarkMaker","infoWindow","contentString","sectionId","queryName","selectedCenter","selectedRadius","request","callback","results","status","filterPlaceMarker","selectedIcon","i"],"mappings":"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"}